{"version":3,"file":"js/100.42bb4de6.js","mappings":"iHAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,CAAM,C,qECRV,MAAMI,GAAiBC,EAAAA,EAAAA,IAAY,SAAU,CACjDC,MAAOA,KAAA,CACJC,cAAe,CACZ,wBAAyB,uCAG/BC,QAAS,CACNC,SAAAA,CAAUC,GACPC,KAAKD,OAASA,CACjB,I,g7BCEN,MAAME,GAAOC,EAAAA,EAAAA,KAAeD,KACtBE,GAAOC,EAAAA,EAAAA,KACPC,GAASC,EAAAA,EAAAA,MACTV,GAAgBH,EAAAA,EAAAA,KAAiBG,cAEjCW,GAAgBC,EAAAA,EAAAA,KAAI,GACpBC,GAAiBD,EAAAA,EAAAA,KAAI,GACrBE,GAAcF,EAAAA,EAAAA,IAAI,IAClBG,GAAeH,EAAAA,EAAAA,IAAI,IACnBI,GAAQJ,EAAAA,EAAAA,IAAI,IACZK,GAAWL,EAAAA,EAAAA,IAAI,IAEfM,EAAgBC,UACnB,MAAMC,EAAOC,EAAE5B,OACfkB,EAAcW,OAAQ,EACtB,MAAMC,QAAiBC,MAAO,GAAEnB,cAAkB,CAC/CoB,OAAQ,OACRC,QAAS,CACN,eAAgB,oBAEnBC,KAAMC,KAAKC,UAAU,CAClBb,MAAOI,EAAKJ,MAAMM,MAClBL,SAAUG,EAAKH,SAASK,UAGxBQ,QAAaP,EAASQ,OAC5BpB,EAAcW,OAAQ,EAClBQ,IACGA,EAAKE,SACNzB,EAAK0B,QAAQH,EAAKA,MAClBrB,EAAOyB,KAAK,MAERJ,EAAK3B,OACNW,EAAYQ,MAAQQ,EAAK3B,OAEzBY,EAAaO,MAAQtB,EAAc8B,EAAKK,UAAY,sBAG7D,E,i2EC5CH,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://tradetrove/./node_modules/vue-loader/dist/exportHelper.js","webpack://tradetrove/./src/stores/errorsStore.js","webpack://tradetrove/./src/views/LoginView.vue","webpack://tradetrove/./src/views/LoginView.vue?5755"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","import { defineStore } from \"pinia\";\r\nexport const useErrorsStore = defineStore(\"errors\", {\r\n   state: () => ({\r\n      errorMessages: {\r\n         'Authentication failed': 'Неверный пароль. Попробуйте снова',\r\n      },\r\n   }),\r\n   actions: {\r\n      setErrors(errors) {\r\n         this.errors = errors;\r\n      },\r\n   },\r\n})","<!-- TODO: сделать восстановление пароля через почту -->\n<!-- TODO: \n   сделать типс (tippy) при наведении на кнопку вход/зарегистрироваться при незаполненных полях\n<button v-tippy=\"{ content: 'Hi!' }\">Tippy!</button> \nhttps://vue-tippy.netlify.app/basic-usage -->\n<script setup>\nimport { ref } from 'vue';\nimport { useHostStore } from '@/stores/hostStore';\nimport { useRouter } from 'vue-router';\nimport { useErrorsStore } from '@/stores/errorsStore';\nimport { useAuthStore } from '@/stores/authStore';\n\nconst host = useHostStore().host;\nconst auth = useAuthStore();\nconst router = useRouter();\nconst errorMessages = useErrorsStore().errorMessages;\n\nconst isFormSending = ref(false);\nconst isPasswordShow = ref(false);\nconst fieldErrors = ref([]);\nconst messageError = ref('');\nconst email = ref('');\nconst password = ref('');\n\nconst sendLoginForm = async (e) => {\n   const form = e.target;\n   isFormSending.value = true;\n   const response = await fetch(`${host}/api/login`, {\n      method: 'POST',\n      headers: {\n         'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n         email: form.email.value,\n         password: form.password.value,\n      }),\n   });\n   const data = await response.json();\n   isFormSending.value = false;\n   if (data) {\n      if (data.success) {\n         auth.setUser(data.data);\n         router.push('/');\n      } else {\n         if (data.errors) {\n            fieldErrors.value = data.errors;\n         } else {\n            messageError.value = errorMessages[data.message] || 'Что-то пошло не так';\n         }\n      }\n   }\n};\n</script>\n<template>\n   <div class=\"center\">\n      <div class=\"login\">\n         <div class=\"container login__content\">\n            <h2 class=\"login__title title\">Вход</h2>\n            <form @submit.prevent=\"sendLoginForm\" class=\"login__form form\">\n               <div class=\"form__fields\">\n                  <div :class=\"{ invalid: fieldErrors.email }\" class=\"form__field form-field\">\n                     <!-- <div class=\"form-field__label\">Email</div> -->\n                     <input\n                        v-model=\"email\"\n                        name=\"email\"\n                        type=\"email\"\n                        class=\"form-field__input\"\n                        placeholder=\"Email\"\n                     />\n                     <div v-if=\"fieldErrors.email\" class=\"form-field__errors\">\n                        <div v-for=\"error in fieldErrors.email\" class=\"form-field__error\">\n                           {{ error }}\n                        </div>\n                     </div>\n                  </div>\n                  <div :class=\"{ invalid: fieldErrors.password }\" class=\"form__field form-field\">\n                     <!-- <div class=\"form-field__label\">Пароль</div> -->\n                     <div\n                        class=\"form-field__input-wrapper form-field__input-wrapper--password\"\n                        :class=\"{ 'show-password': isPasswordShow }\"\n                     >\n                        <input\n                           v-model=\"password\"\n                           name=\"password\"\n                           :type=\"isPasswordShow ? 'text' : 'password'\"\n                           class=\"form-field__input\"\n                           placeholder=\"Пароль\"\n                        />\n                        <button\n                           @click=\"isPasswordShow = !isPasswordShow\"\n                           type=\"button\"\n                           class=\"form-field__toggle-pas form-field__toggle-pas--show\"\n                        >\n                           <font-awesome-icon icon=\"eye\" />\n                        </button>\n                        <button\n                           @click=\"isPasswordShow = !isPasswordShow\"\n                           type=\"button\"\n                           class=\"form-field__toggle-pas form-field__toggle-pas--hide\"\n                        >\n                           <font-awesome-icon icon=\"eye-slash\" />\n                        </button>\n                     </div>\n                     <div v-if=\"fieldErrors.password\" class=\"form-field__errors\">\n                        <div v-for=\"error in fieldErrors.password\" class=\"form-field__error\">\n                           {{ error }}\n                        </div>\n                     </div>\n                  </div>\n               </div>\n\n               <div class=\"form__actions\">\n                  <router-link to=\"/restore\" class=\"link\">Восстановить пароль</router-link>\n               </div>\n               <div class=\"form__btn-wrapper\">\n                  <div\n                     v-if=\"!email || !password\"\n                     v-tippy=\"{ content: 'Заполните все поля' }\"\n                     class=\"form__btn-wrapper-wrapper\"\n                  >\n                     <button\n                        :class=\"{ 'btn-loader': isFormSending }\"\n                        :disabled=\"!email || !password || isFormSending ? true : false\"\n                        class=\"form__btn btn\"\n                        type=\"submit\"\n                     >\n                        Войти\n                     </button>\n                  </div>\n                  <button\n                     v-else\n                     :class=\"{ 'btn-loader': isFormSending }\"\n                     :disabled=\"!email || !password || isFormSending ? true : false\"\n                     class=\"form__btn btn\"\n                     type=\"submit\"\n                  >\n                     Войти\n                  </button>\n                  <!-- <button v-tippy=\"{ content: 'Hi!' }\" :disabled=\"!email || !password || isFormSending ? true : false\">Tippy!</button>  -->\n               </div>\n               <div class=\"form__error\">{{ messageError }}</div>\n            </form>\n            <div class=\"login__register-wrapper\">\n               <router-link class=\"login__register link\" to=\"/register\"\n                  >Зарегистрироваться</router-link\n               >\n            </div>\n            <div class=\"login__agreement\">\n               <p>\n                  При регистрации и входе вы соглашаетесь с условиями использования TradeTrove и\n                  политикой конфиденциальности.\n               </p>\n            </div>\n         </div>\n      </div>\n   </div>\n</template>\n\n<style scoped lang=\"scss\">\n.container {\n}\n.login {\n   max-width: 530px;\n   width: 100%;\n   margin: 0 auto;\n   // .login__content\n   &__content {\n      // display: flex;\n      // flex-direction: column;\n   }\n   // .login__title\n   &__title {\n      margin-bottom: 20px;\n      text-align: center;\n   }\n   // .login__form\n   &__form {\n   }\n\n   // .login__register-wrapper\n   &__register-wrapper {\n      margin-top: 10px;\n      display: flex;\n      justify-content: center;\n      text-align: center;\n   }\n   // .login__register\n   &__register {\n   }\n   // .login__agreement\n   &__agreement {\n      margin-top: 25px;\n      text-align: center;\n      font-size: 14px;\n      font-weight: 400;\n   }\n}\n</style>\n","import script from \"./LoginView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LoginView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=4a1c68aa&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4a1c68aa\"]])\n\nexport default __exports__"],"names":["exports","sfc","props","target","__vccOpts","key","val","useErrorsStore","defineStore","state","errorMessages","actions","setErrors","errors","this","host","useHostStore","auth","useAuthStore","router","useRouter","isFormSending","ref","isPasswordShow","fieldErrors","messageError","email","password","sendLoginForm","async","form","e","value","response","fetch","method","headers","body","JSON","stringify","data","json","success","setUser","push","message","__exports__"],"sourceRoot":""}